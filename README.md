<h1>Splunk Security Monitoring Project</h1>

<p>The slide deck contgains screenshots of the Splunk environment I built and a summary of my lessons learned. Here, I'll summarize the experience in text.</p>

<p>I acquired two sets of log data from a simulated corporation, including both linux and windows operating systems. The first was a set of baseline logs, collected under normal operating conditions. The second was a set of logs collected during a cyber attack that was targeting an employee login portal. Using the first set of logs, I created rules to provide enhanced visibility into the data; since there were thouseands of log entries, it was of littel practical use in bulk. The rules were centered on tying together relevant information, such as linking failed login events to the users involved and charting that data over time. I also created alerts to notify me when certain events exceeded a threshold. I typically set that threshold at somewhere between 20-30% of baseline values. The Splunk UI is fantastic, and creating rules and alerts is quick and straitforward; therefore the crux of setting up security monitoring for an organization lies in choosing what metrics to monitor and how. 

<p>I set out on this project to learn how to use Splunk; I thought that meant learning how to navigate the various drop-down menus and how to integrate log data. I figured the hard part would be learning a new query language and maybe figuring out how to make the data easy to read. Once I got into it though, I found that Splunk has the User Interface (UI) and user education pretty well polished. There are hundreds of hours worth of video tutorials and forum posts on about anything you might want to do with your Splunk deployment. Furthermore, the dashboards almost build themselves (literally, there are pages of pre-built dashboards to choose from), and the same can more or less be said about rules and alerts. The problem I should have been worried about was this: <em>What data should I look at and how do I know which metrics will be relevant when I get hit with an arbitrary cyber attack at some unknown point in the future?</em> I imagine you could put a warehouse full of SOC Analysts on the task of researching the early attack indicators of various cyber threats and still end up missing some. Thankfully, Splunk knows this. There are countless add-on apps that you can integrate with your deployment to hone your detection capabilities. I used Splunk Security Essentials (SSE) because it was available to me while using the Splunk free trial, and to be honest, I didn't expect much from the free version - turns out my skepticism was unfounded. SSE is a Splunk-supported app that provides pre-built templates that enhance data visibility. These templates can be made to fit various security frameworks, such as the Cyber Kill Chain or MITRE ATT&CK. There are hundreds of modules in SSE, but to give you an idea of why they're so helpful I'll highlight a few here. There is an SSE module that detects when a network scan is occurring, another module searches for signs of malware on hosts within your organization, and there's even a module that searches for user credentials in files! I see login credentials saved in clear text all the time when performing CTF's or Pen-testing labs; it's my favorite way to escalate privileges or move laterally. I'm not saying Splunk add-ons are the end-all, but I can't emphasize enough how valuable that saved-time is when building a monitoring environment, especially for a smaller security team. That said, there's still plenty of work left to us SOC Analysts. The host malware detection module won't help you if you don't have endpoint monitoring set up on your hosts, so that'll need to be configured. Sometimes you'll have to sift through a handfull of modules to find one suited for your OS, or that works with your specfic firewall configuration. You need to decide what your specific attack surface looks like and cater your SSE modules to fit, just like you did when configuring a monitoring environemt by hand. But now you get a much greater return on investment for time spent. I've used both Splunk and Elasticsearch to build a monitoring environment and what sets them apart is the add-ons. There are thousands of them, some built and supported by Splunk, but most built by the massive community of cybersecurity professionals that use Splunk.</p>
