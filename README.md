<h1>Splunk Security Monitoring Project</h1>

<p>The slide deck contains a visual summary of the Splunk environment I built and it's mostly made up of before and after pictures. Here, I'll give a more detailed summary of the experience in text.</p>

<p>I acquired two sets of log data from a simulated corporation, including both linux and windows operating systems. The first was a set of baseline logs, collected under normal operating conditions. The second was a set of logs collected during a cyber attack that was targeting an employee login portal. Using the first set of logs, I created rules to provide enhanced visibility into the data; since there were thousands of log entries, it was of little practical use in bulk. The rules were centered on tying together relevant information, such as linking failed login events to the users involved and charting that data over time. I also created alerts to notify me when certain events exceeded a given threshold. I typically set that threshold at somewhere between 20-30% above baseline values. I also used the rules I created to build a dashboard full of charts for user login data, graphs of system events over time, and a geolocation map for incoming and outgoing network traffic. I decided to pass in the attack logs, and to my delight, the alerts triggered and the dashboard elements showed some pretty obvious signs of malicious activity. Take a look at the slide deck if you want to check out the differences my deployment picked up on during the attack. I learned everything I needed to know to set up this (pretty basic) monitoring environment in a few evenings. 

<p>Here's the catch: I already knew what kind of attack I was looking for when I started building this deployment. I set out on this project to learn how to use Splunk; I thought that meant learning how to navigate the various drop-down menus and how to integrate log data. I figured the hard part would be learning a new query language and maybe figuring out how to make the data easy to read. Once I got into it though, I found that Splunk has the User Interface (UI) and user education pretty well polished. There are hundreds of hours worth of video tutorials and forum posts on about anything you might want to do with your Splunk deployment. Furthermore, the dashboards almost build themselves (there are several pages of pre-built dashboards to choose from), and the same can more or less be said about rules and alerts. Though I will say, it's a little more satisfying to build those all yourself if you have the free time. After a few evenings spent learning the platform, I found that the crux of building my own SIEM deployment was this: <em>What data should I look at and how do I know which metrics will be relevant when I get hit with an arbitrary cyber attack at some unknown point in the future?</em> </p>
  
<p>I imagine you could put a warehouse full of SOC Analysts on the task of researching the early attack indicators of various cyber threats and still end up missing some. Thankfully, Splunk knows this. There are countless add-on apps that you can integrate with your deployment to hone your detection capabilities. I used Splunk Security Essentials (SSE) because it was available to me while using the Splunk free trial, and to be honest, I didn't expect much from the free version - turns out my skepticism was unfounded. SSE is a Splunk-supported app that provides pre-built templates that enhance data visibility. These templates can be made to fit various security frameworks, such as the Cyber Kill Chain or MITRE ATT&CK. There are hundreds of modules in SSE, but to give you an idea of why they're so helpful I'll highlight a few here. There is an SSE module that detects when a network scan is occurring, another module searches for signs of malware on hosts within your organization, and there's even a module that searches for user credentials in files! I see login credentials saved in clear text all the time when performing CTF's or Pen-testing labs; it's my favorite way to escalate privileges or move laterally. I'm not saying Splunk add-ons are the end-all, but I can't emphasize enough how valuable that saved-time is when building a monitoring environment, especially for a smaller security team. That said, there's still plenty of work left to us SOC Analysts. The host malware detection module won't help you if you don't have endpoint monitoring set up on your hosts, so that'll need to be configured. Sometimes you'll have to sift through a handfull of modules to find one suited for your OS, or that works with your specfic firewall configuration. You need to decide what your specific attack surface looks like and cater your SSE modules to fit, just like you did when configuring a monitoring environemt by hand. But now you get a much greater return on investment for time spent. I've used both Splunk and Elasticsearch to build a monitoring environment and what sets them apart is the add-ons. There are thousands of them, some built and supported by Splunk and others built by the massive community of cybersecurity professionals that use Splunk. Elasticsearch has add-ons too, and they're not bad especially when you consider the price difference between an enterprise Splunk deployment and one built on Elasticsearch. If you can't afford Splunk, Elasticsearch is leaps and bounds better than nothing. But Splunk is purpose-built for security monitoring, and it has more community and vendor support. Simply put, using1 Splunk and it's accompanying add-ons for you SIEM solution can multiply the effectiveness of your SOC team by a great deal.</p>
